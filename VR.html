<html>
  <head>
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
  </head>
  <body>
      <script>
          var index = 0;
           questions = [
                {
                    "question" : "Instruction: Stand inside the ring, use green and red boxes for navigation. Speak your answers and confirm it once appeared"
                },
                {
                    "variable" : "name",
                    "question" : "What is your name?"
                },
                {
                    "variable" : "age",
                    "question" : "What is your age?"
                }
            ]
            answers = {}
        document.addEventListener("keypress", function(e){
            if(e.key=="k" && index<2){
                index =index + 1
            }
            document.getElementById("question").setAttribute('value', questions[index]["question"] )
        })
        AFRAME.registerComponent('listener', {
  tick: function () {
    //console.log(this.el.getAttribute('position'));
  }
});
    AFRAME.registerComponent('form-text', {
        init:function(){
            //var index = 0;
           
            console.log("initiating")
            this.el.addEventListener('fusing', function(e){
                console.log(index)
                // var cameraPos = document.getElementsByTagName("a-camera")[0].getAttribute("position")
                // if(cameraPos.x )
                // TODO: Activated only when camera inside the ring
                if(e.srcElement.id=="next" && index<2)
                    index =index + 1
                else if(e.srcElement.id=="back" && index>0)
                    index =index - 1
                document.getElementById("question").setAttribute('value', questions[index]["question"] )
                if(answers[questions[index].variable])
                    document.getElementById("answer").setAttribute('value', answers[questions[index].variable])
                else
                    document.getElementById("answer").setAttribute('value', "")
            })
        }
    })
    AFRAME.registerComponent('record', {
        init: function(){
            this.el.addEventListener('fusing', function(){
                var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
                var rec = new SpeechRecognition();
		        rec.start();	
		        rec.addEventListener('result', function(e){
                var last = e.results.length - 1;
                var word = e.results[last][0];
			    document.write(word.transcript);
                })
            })
        }
    })
    </script>
    <a-scene>
        <a-camera listener>  <a-cursor fuse="true"></a-cursor></a-camera>
      <!--<a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>-->
      <a-sky src="moving.gif"></a-sky> <!--GIF animation not wokring-->
      <a-text id="question" position="-0.9 0.2 -3" scale="1.5 1.5 1.5" color="yellow" align="center" width="8" value="Instruction: Stand inside the ring, use green and red boxes for navigation. Speak your answers and confirm it once appeared"></a-text>
      <a-text id="answer" position="-0.9 -1.3 -3" scale="1.5 1.5 1.5" color="yellow" align="center" width="8" value="Your answers will appear here"></a-text>
      <a-box form-text id="next" position="4 0 0" depth="0.3" height="0.3" width="0.3" color="green"></a-box>
      <a-box form-text id="back" position="-4 0 0" depth="0.3" height="0.3" width="0.3" color="red"></a-box>
      <a-box record id="reply" position="0 -2 0" depth="0.3" height="0.3" width="0.3" color="teal"></a-box>
      <a-torus position="1.5 -2 4" color="black" arc="360" radius="1" radius-tubular="0.05" rotation="90 90 90"></a-torus>
    </a-scene> 
  </body>
</html>